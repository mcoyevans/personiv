var app=angular.module("app",["shared"]);app.config(["$stateProvider",function(e){e.state("main",{url:"/",views:{"":{templateUrl:"/app/shared/views/main.view.html",controller:"mainViewController"},"content-container@main":{templateUrl:"/app/shared/views/content-container.view.html",controller:"postsContentContainerController"},"toolbar@main":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"postsToolbarController"},"left-sidenav@main":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main":{templateUrl:"/app/components/posts/templates/content/posts.template.html"}}}).state("main.slideshow",{url:"slideshow/{slideshowID}",resolve:{authorization:["Helper","$state",function(e,t){e.get("/slideshow/create").success(function(e){}).error(function(){return t.go("page-not-found")})}]},params:{slideshowID:null},views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"slideshowContentContainerController"},"toolbar@main.slideshow":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"slideshowToolbarController"},"left-sidenav@main.slideshow":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.slideshow":{templateUrl:"/app/components/app/templates/content/slideshow-content.template.html"}}}).state("main.approvals",{url:"approvals",views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"approvalsContentContainerController"},"toolbar@main.approvals":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"approvalsToolbarController"},"subheader@main.approvals":{templateUrl:"/app/components/reservations/templates/subheaders/reservations-subheader.template.html",controller:"approvalsSubheaderController"},"left-sidenav@main.approvals":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.approvals":{templateUrl:"/app/components/approvals/templates/content/approvals-content.template.html"}}}).state("main.reservations",{url:"reservations",views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"reservationsContentContainerController"},"toolbar@main.reservations":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"reservationsToolbarController"},"subheader@main.reservations":{templateUrl:"/app/components/reservations/templates/subheaders/reservations-subheader.template.html",controller:"reservationsSubheaderController"},"left-sidenav@main.reservations":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.reservations":{templateUrl:"/app/components/reservations/templates/content/reservations-content.template.html"}}}).state("main.birthdays",{url:"settings/birthdays",resolve:{authorization:["Helper","$state",function(e,t){e.get("/birthday/create").success(function(e){}).error(function(){return t.go("page-not-found")})}]},views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"birthdaysContentContainerController"},"toolbar@main.birthdays":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"birthdaysToolbarController"},"left-sidenav@main.birthdays":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.birthdays":{templateUrl:"/app/components/settings/templates/content/settings-content.template.html"}}}).state("main.upload",{url:"settings/birthdays/upload",resolve:{authorization:["Helper","$state",function(e,t){e.get("/birthday/create").success(function(e){}).error(function(){return t.go("page-not-found")})}]},views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"uploadContentContainerController"},"toolbar@main.upload":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"uploadToolbarController"},"left-sidenav@main.upload":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.upload":{templateUrl:"/app/components/settings/templates/content/upload-content.template.html"}}}).state("main.equipment",{url:"settings/equipment",resolve:{authorization:["Helper","$state",function(e,t){e.get("/equipment/create").success(function(e){}).error(function(){return t.go("page-not-found")})}]},views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"equipmentContentContainerController"},"toolbar@main.equipment":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"equipmentToolbarController"},"subheader@main.equipment":{templateUrl:"/app/components/settings/templates/subheaders/equipment-subheader.template.html",controller:"equipmentSubheaderController"},"left-sidenav@main.equipment":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.equipment":{templateUrl:"/app/components/settings/templates/content/settings-content.template.html"}}}).state("main.groups",{url:"settings/groups",resolve:{authorization:["Helper","$state",function(e,t){e.get("/group/create").success(function(e){}).error(function(){return t.go("page-not-found")})}]},views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"groupsContentContainerController"},"toolbar@main.groups":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"groupsToolbarController"},"left-sidenav@main.groups":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.groups":{templateUrl:"/app/components/settings/templates/content/settings-content.template.html"}}}).state("main.links",{url:"settings/links",resolve:{authorization:["Helper","$state",function(e,t){e.get("/link/create").success(function(e){}).error(function(){return t.go("page-not-found")})}]},views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"linksContentContainerController"},"toolbar@main.links":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"linksToolbarController"},"left-sidenav@main.links":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.links":{templateUrl:"/app/components/settings/templates/content/settings-content.template.html"}}}).state("main.forms",{url:"settings/forms",resolve:{authorization:["Helper","$state",function(e,t){e.get("/form/create").success(function(e){}).error(function(){return t.go("page-not-found")})}]},views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"formsContentContainerController"},"toolbar@main.forms":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"formsToolbarController"},"left-sidenav@main.forms":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.forms":{templateUrl:"/app/components/settings/templates/content/settings-content.template.html"}}}).state("main.locations",{url:"settings/rooms",resolve:{authorization:["Helper","$state",function(e,t){e.get("/location/create").success(function(e){}).error(function(){return t.go("page-not-found")})}]},views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"locationsContentContainerController"},"toolbar@main.locations":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"locationsToolbarController"},"left-sidenav@main.locations":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.locations":{templateUrl:"/app/components/settings/templates/content/settings-content.template.html"}}}).state("main.users",{url:"settings/users",resolve:{authorization:["Helper","$state",function(e,t){e.get("/user/create").success(function(e){}).error(function(){return t.go("page-not-found")})}]},views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"usersContentContainerController"},"toolbar@main.users":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"usersToolbarController"},"left-sidenav@main.users":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.users":{templateUrl:"/app/components/settings/templates/content/settings-content.template.html"}}}).state("main.notifications",{url:"notifications",views:{"content-container":{templateUrl:"/app/shared/views/content-container.view.html",controller:"notificationsContentContainerController"},"toolbar@main.notifications":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"notificationsToolbarController"},"left-sidenav@main.notifications":{templateUrl:"/app/shared/templates/sidenavs/main-left-sidenav.template.html"},"content@main.notifications":{templateUrl:"/app/components/notifications/templates/content/notifications-content.template.html"}}})}]),app.controller("mainViewController",["$scope","$filter","$state","$mdDialog","$mdSidenav","$mdToast","Helper","FileUploader",function(e,t,o,n,r,a,i,s){e.toggleSidenav=function(e){r(e).toggle()},e.menu={},e.menu.pages=[],e.menu["static"]=[{state:"main",icon:"mdi-home",label:"Home"},{state:"main.reservations",icon:"mdi-format-list-numbers",label:"Training Room Reservations"},{state:"main.notifications",icon:"mdi-bell",label:"Notifications"}],e.menu.section=[{name:"Apps",icon:"mdi-application"},{name:"Forms",icon:"mdi-file-document"}],e.setActive=function(e){angular.element($('[aria-label="section-'+e+'"]').closest("li").toggleClass("active")),angular.element($('[aria-label="section-'+e+'"]').closest("li").siblings().removeClass("active"))},e.logout=function(){i.post("/user/logout").success(function(){window.location.href="/"})},e.changePassword=function(){n.show({controller:"changePasswordDialogController",templateUrl:"/app/shared/templates/dialogs/change-password-dialog.template.html",parent:angular.element(document.body),fullscreen:!0}).then(function(){i.notify("Password changed.")})};var l={};l.filter={name:"photoFilter",fn:function(e,t){var o="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(o)!==-1}},l.sizeFilter={name:"enforceMaxFileSize",fn:function(e){return e.size<=2e6}},l.error=function(t,o,n){e.fileError=!0,e.photoUploader.queue=[]},l.headers={"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},e.clickUpload=function(){angular.element("#upload").trigger("click")},e.markAllAsRead=function(){i.post("/user/mark-all-as-read").success(function(){e.user.unread_notifications=[]})};i.post("/user/check").success(function(t){var n=!1,r=[];angular.forEach(t.roles,function(a){if("posts"==a.name)t.can_post=!0;else if("approvals"==a.name){var i={state:"main.approvals",icon:"mdi-clipboard-check",label:"Approvals"};e.menu["static"].push(i)}else if("manage-groups"==a.name){n=!0;var i={label:"Groups",action:function(){o.go("main.groups")}};r.push(i)}else if("manage-users"==a.name){n=!0;var i={label:"Users",action:function(){o.go("main.users")}};r.push(i)}else if("manage-locations"==a.name){n=!0;var i={label:"Rooms",action:function(){o.go("main.locations")}};r.push(i)}else if("manage-equipment"==a.name){n=!0;var i={label:"Equipment",action:function(){o.go("main.equipment")}};r.push(i)}else if("manage-links"==a.name){n=!0;var i={label:"Links",action:function(){o.go("main.links")}};r.push(i)}else if("manage-birthdays"==a.name){n=!0;var i={label:"Birthdays",action:function(){o.go("main.birthdays")}};r.push(i)}else if("manage-forms"==a.name){n=!0;var i={label:"Forms",action:function(){o.go("main.forms")}};r.push(i)}}),n&&(e.menu.section[2]={name:"Settings",icon:"mdi-settings"},e.menu.pages[2]=r),e.user=t,e.currentTime=Date.now(),i.setAuthUser(t),e.photoUploader=new s({url:"/user/upload-avatar/"+e.user.id,headers:l.headers,queueLimit:1}),e.photoUploader.filters.push(l.filter),e.photoUploader.filters.push(l.sizeFilter),e.photoUploader.onWhenAddingFileFailed=l.error,e.photoUploader.onAfterAddingFile=function(){e.fileError=!1,e.photoUploader.queue.length&&e.photoUploader.uploadAll()},e.photoUploader.onCompleteItem=function(t,n){e.user.avatar_path?(e.currentTime=Date.now(),e.photoUploader.queue=[]):o.go(o.current,{},{reload:!0})},i.post("/pusher/config").success(function(t){var n=new Pusher(t.key,{cluster:t.cluster,encrypted:!0,auth:{headers:{"X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}}),r={};r.user=n.subscribe("private-App.User."+e.user.id),r.user.bindings=[r.user.bind("Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",function(t){t.created_at=t.attachment.created_at,t.data={},t.data.attachment=t.attachment,t.data.url=t.url,t.data.withParams=t.withParams,t.data.sender=t.sender,t.data.message=t.message,e.$apply(function(){e.user.unread_notifications.unshift(t)}),i.notify(t.sender.name+" "+t.message),o.current.name==t.data.url&&o.go(o.current,{},{reload:!0})})]}).error(function(){i.error()})}),e.markAsRead=function(t){i.post("/user/mark-as-read",t).success(function(){var o=e.user.unread_notifications.indexOf(t);e.user.unread_notifications.splice(o,1)}).error(function(){i.error()})},e.read=function(t){o.go(t.data.url),"App\\Notifications\\PostCreated"==t.type||"App\\Notifications\\RepostCreated"==t.type?(i.set(t.data.attachment.id),e.$broadcast("read-post")):"App\\Notifications\\CommentCreated"==t.type?(i.set(t.data.attachment.post_id),e.$broadcast("read-post-and-comments")):"App\\Notifications\\ReservationCreated"==t.type&&(i.set(t.data.attachment.id),e.$broadcast("read-approval")),e.markAsRead(t)},e.fetchLinks=function(){i.get("/link").success(function(t){var o=[];angular.forEach(t,function(e){var t={};t.label=e.name,t.action=function(){window.open(e.link)},o.push(t)}),e.menu.pages[0]=o})},e.fetchForms=function(){i.get("/form").success(function(t){var o=[];angular.forEach(t,function(e){var t={};t.label=e.name,t.action=function(){window.open("/form/"+e.id)},o.push(t)}),e.menu.pages[1]=o})},e.fetchLinks(),e.fetchForms(),e.$on("closeSidenav",function(){r("left").close()}),e.$on("fetchLinks",function(){e.fetchLinks()}),e.$on("fetchForms",function(){e.fetchForms()})}]),app.controller("reservationsContentContainerController",["$scope","$compile","Helper","uiCalendarConfig",function(e,t,o,n){e.$emit("closeSidenav"),e.toolbar={},e.toolbar.sortBy=function(t){t.sortReverse=!t.sortReverse,e.sortType=t.type,e.sortReverse=t.sortReverse},e.subheader={},e.subheader.show=!0,e.subheader.current={},e.fab={},e.fab.icon="mdi-plus",e.fab.label="Reservation",e.fab.action=function(){o.set(e.subheader.current.fab),o.customDialog(e.subheader.current.fab).then(function(){o.notify("Reservation created."),e.refresh()},function(){})},e.viewReservation=function(e){o.set(e);var t={template:"/app/components/reservations/templates/dialogs/approved-reservation-dialog.template.html",controller:"approvedReservationDialogController"};o.customDialog(t)},e.editReservation=function(t){t.action="edit",o.set(t);var n={template:"/app/components/reservations/templates/dialogs/reservation-dialog.template.html",controller:"reservationDialogController"};o.customDialog(n).then(function(){o.notify("Reservation updated."),e.refresh()},function(){})},e.deleteReservation=function(t){var n={};n.title="Delete",n.message="Delete this reservation?",n.ok="Delete",n.cancel="Cancel",o.confirm(n).then(function(){o.preload(),o["delete"]("/reservation/"+t.id).success(function(){e.refresh(),o.stop(),o.notify("Reservation deleted.")}).error(function(){o.error()})},function(){})},e.disapproveReservation=function(t){var n={};n.title="Disapprove",n.message="Disapprove this reservation?",n.ok="Disapprove",n.cancel="Cancel",o.confirm(n).then(function(){o.preload(),o.post("/reservation/disapprove",t).success(function(){e.refresh(),o.stop(),o.notify("Reservation disapproved.")}).error(function(){o.error()})},function(){})},e.uiConfig={calendar:{height:500,editable:!1,header:{left:"title",center:"",right:"today prev,next"},eventClick:e.viewReservation,eventDrop:e.alertOnDrop,eventResize:e.alertOnResize,viewRender:function(t){e.dateRange={},e.dateRange.start=new Date(t.start._d).toDateString(),e.dateRange.end=new Date(t.end._d).toDateString(),e.isLoading=!0,o.set(e.dateRange),e.$broadcast("dateRange"),e.init(e.subheader.current)}}},e.eventSources=[],e.changeView=function(e){n.calendars.reservationCalendar.fullCalendar("changeView",e)},e.calendarType="month",e.$on("setInit",function(){e.isLoading=!0,e.$broadcast("close");var t=o.fetch();e.subheader.current=t,e.init(t)}),e.$on("search",function(){e.subheader.current.request.search=e.toolbar.searchText,e.refresh()}),e.$on("refresh",function(){e.subheader.current.request.search=null,e.$broadcast("close"),e.refresh()});var r=function(t){t.deleted_at=t.deleted_at?new Date(t.deleted_at):null,t.created_at=new Date(t.created_at),t.start=new Date(t.start),t.end=new Date(t.end);var o={};o.display=t.title,e.toolbar.items.push(o)};e.init=function(t){e.reservation={},e.toolbar.items=[],o.post("/user/check").success(function(n){angular.forEach(n.roles,function(e){"reservations"==e.name&&(n.can_reserve=!0),"approvals"==e.name&&(n.can_approve=!0)}),e.current_user=n,o.post("/reservation/enlist",t.request).success(function(t){e.eventSources.splice(0,1),e.isLoading=!1,e.reservation.approved=[],e.reservation.pending=[],t.length&&(angular.forEach(t,function(t){r(t),t.schedule_approver_id&&!t.disapproved_schedule?(t.title=t.title+" - "+t.location.name,e.reservation.approved.push(t)):e.reservation.pending.push(t)}),e.eventSources.push(e.reservation.approved)),e.fab.show=!!e.current_user.can_reserve,e.refresh=function(){e.isLoading=!0,e.init(e.subheader.current)}})})}}]),app.controller("birthdaysContentContainerController",["$scope","Helper",function(e,t){e.$emit("closeSidenav"),e.toolbar={},e.toolbar.toggleActive=function(){e.showInactive=!e.showInactive},e.toolbar.sortBy=function(t){t.sortReverse=!t.sortReverse,e.sortType=t.type,e.sortReverse=t.sortReverse},e.fab={},e.fab.icon="mdi-plus",e.fab.label="Birthday",e.fab.action=function(){var o={template:"/app/components/settings/templates/dialogs/birthday-dialog.template.html",controller:"birthdayDialogController"};o.action="create",t.set(o),t.customDialog(o).then(function(){t.notify("Birthday created."),e.refresh()},function(){})},e.$on("search",function(){e.showInactive=!0,e.request.search=e.toolbar.searchText,e.refresh()}),e.$on("refresh",function(){e.request.search=null,e.$broadcast("close"),e.refresh()}),e.updateModel=function(o){var n={template:"/app/components/settings/templates/dialogs/birthday-dialog.template.html",controller:"birthdayDialogController"};o.action="edit",t.set(o),t.customDialog(n).then(function(){e.refresh(),t.notify("Birthday updated.")},function(){})},e.deleteModel=function(o){var n={};n.title="Delete",n.message="Delete "+o.last_name+", "+o.first_name+" "+o.middle_name.charAt(0)+".?",n.ok="Delete",n.cancel="Cancel",t.confirm(n).then(function(){t["delete"]("/birthday/"+o.id).success(function(){e.refresh(),t.notify("Birthday deleted.")}).error(function(){t.error()})},function(){})};var o=function(t){t.deleted_at=t.deleted_at?new Date(t.deleted_at):null,t.birthdate=new Date(t.birthdate);var o={};o.display=t.full_name,e.toolbar.items.push(o)};e.init=function(n){e.model={},e.model.items=[],e.toolbar.items=[],e.model.page=2,t.post("/birthday/enlist",n).success(function(r){e.model.details=r,e.model.items=r.data,e.model.show=!0,e.fab.show=!0,r.data.length&&angular.forEach(r.data,function(e){o(e)}),e.model.paginateLoad=function(){return e.model.busy||e.model.page>e.model.details.last_page?void(e.isLoading=!1):(e.model.busy=!0,e.isLoading=!0,void t.post("/birthday/enlist?page="+e.model.page,n).success(function(t){e.model.page++,angular.forEach(t.data,function(t,n){o(t),e.model.items.push(t)}),e.model.busy=!1,e.isLoading=!1}))}})},e.refresh=function(){e.isLoading=!0,e.model.show=!1,e.init(e.request)},e.request={},e.request.paginate=20,e.request.withCount=[{relation:"users",withTrashed:!1}],e.isLoading=!0,e.$broadcast("close"),e.init(e.request)}]),app.controller("equipmentContentContainerController",["$scope","Helper",function(e,t){e.$emit("closeSidenav"),e.toolbar={},e.toolbar.toggleActive=function(){e.showInactive=!e.showInactive},e.toolbar.sortBy=function(t){t.sortReverse=!t.sortReverse,e.sortType=t.type,e.sortReverse=t.sortReverse},e.subheader={},e.subheader.show=!0,e.fab={},e.fab.icon="mdi-plus",e.$on("setInit",function(){var o=t.fetch();e.subheader.current=o,e.isLoading=!0,e.init(o),e.$broadcast("close"),e.showInactive=!1}),e.$on("search",function(){e.subheader.current.request.search=e.toolbar.searchText,e.refresh(),e.showInactive=!0}),e.$on("refresh",function(){e.subheader.current.request.search=null,e.$broadcast("close"),e.refresh()}),e.updateModel=function(o){var n={template:"/app/components/settings/templates/dialogs/equipment-dialog.template.html",controller:"equipmentDialogController"};o.action="edit",t.set(o),t.customDialog(n).then(function(){e.refresh(),t.notify("Equipment updated.")},function(){})},e.deleteModel=function(o){var n={};n.title="Delete",n.message="Delete "+o.asset_tag+"?",n.ok="Delete",n.cancel="Cancel",t.confirm(n).then(function(){t["delete"]("/equipment/"+o.id).success(function(){e.refresh(),t.notify("Equipment deleted.")}).error(function(){t.error()})},function(){})};var o=function(t){t.deleted_at=t.deleted_at?new Date(t.deleted_at):null;var o={};o.display=t.asset_tag,o.brand=t.brand,o.model=t.model,e.toolbar.items.push(o)};e.init=function(n,r){e.model={},e.model.items=[],e.toolbar.items=[],e.model.page=2,t.post("/equipment/enlist",n.request).success(function(r){e.model.details=r,e.model.items=r.data,e.model.show=!0,e.fab.label=n.label,e.fab.action=function(){t.set(n.fab),t.customDialog(n.fab).then(function(){t.notify(n.fab.message),e.refresh()},function(){})},e.fab.show=!0,r.data.length&&angular.forEach(r.data,function(e){o(e)}),e.model.paginateLoad=function(){return e.model.busy||e.model.page>e.model.details.last_page?void(e.isLoading=!1):(e.model.busy=!0,e.isLoading=!0,void t.post("/equipment/enlist?page="+e.model.page,n.request).success(function(t){e.model.page++,angular.forEach(t.data,function(t,n){o(t),e.model.items.push(t)}),e.model.busy=!1,e.isLoading=!1}))}})},e.refresh=function(){e.isLoading=!0,e.model.show=!1,e.init(e.subheader.current)}}]),app.controller("formsContentContainerController",["$scope","Helper",function(e,t){e.$emit("closeSidenav"),e.toolbar={},e.toolbar.toggleActive=function(){e.showInactive=!e.showInactive},e.toolbar.sortBy=function(t){t.sortReverse=!t.sortReverse,e.sortType=t.type,e.sortReverse=t.sortReverse},e.fab={},e.fab.icon="mdi-plus",e.fab.label="Form",e.fab.action=function(){var o={template:"/app/components/settings/templates/dialogs/form-dialog.template.html",controller:"formDialogController"};o.action="create",t.set(o),t.customDialog(o).then(function(){t.notify("Form created."),e.refresh()},function(){})},e.$on("search",function(){e.showInactive=!0,e.request.search=e.toolbar.searchText,e.refresh()}),e.$on("refresh",function(){e.showInactive=!1,e.request.search=null,e.$broadcast("close"),e.refresh()}),e.updateModel=function(o){var n={template:"/app/components/settings/templates/dialogs/form-dialog.template.html",controller:"formDialogController"};o.action="edit",t.set(o),t.customDialog(n).then(function(){e.refresh(),t.notify("Form updated.")},function(){})},e.deleteModel=function(o){var n={};n.title="Delete",n.message="Delete "+o.name+"?",n.ok="Delete",n.cancel="Cancel",t.confirm(n).then(function(){t["delete"]("/form/"+o.id).success(function(){e.refresh(),t.notify("Form deleted.")}).error(function(){t.error()})},function(){})};var o=function(t){t.deleted_at=t.deleted_at?new Date(t.deleted_at):null;var o={};o.display=t.name,e.toolbar.items.push(o)};e.init=function(n){e.model={},e.model.items=[],e.toolbar.items=[],e.model.page=2,t.post("/form/enlist",n).success(function(r){e.model.details=r,e.model.items=r.data,e.model.show=!0,e.fab.show=!0,r.data.length&&angular.forEach(r.data,function(e){o(e)}),e.model.paginateLoad=function(){return e.model.busy||e.model.page>e.model.details.last_page?void(e.isLoading=!1):(e.model.busy=!0,e.isLoading=!0,void t.post("/form/enlist?page="+e.model.page,n).success(function(t){e.model.page++,angular.forEach(t.data,function(t,n){o(t),e.model.items.push(t)}),e.model.busy=!1,e.isLoading=!1}))}})},e.refresh=function(){e.isLoading=!0,e.model.show=!1,e.init(e.request),e.$emit("fetchForms")},e.request={},e.request.paginate=20,e.isLoading=!0,e.$broadcast("close"),e.init(e.request)}]),app.controller("groupsContentContainerController",["$scope","Helper",function(e,t){e.$emit("closeSidenav"),e.toolbar={},e.toolbar.toggleActive=function(){e.showInactive=!e.showInactive},e.toolbar.sortBy=function(t){t.sortReverse=!t.sortReverse,e.sortType=t.type,e.sortReverse=t.sortReverse},e.fab={},e.fab.icon="mdi-plus",e.fab.label="Groups",e.fab.action=function(){var o={template:"/app/components/settings/templates/dialogs/group-dialog.template.html",controller:"groupDialogController"};o.action="create",t.set(o),t.customDialog(o).then(function(){t.notify("Group created."),e.refresh()},function(){})},e.$on("search",function(){e.showInactive=!0,e.request.search=e.toolbar.searchText,e.refresh()}),e.$on("refresh",function(){e.request.search=null,e.$broadcast("close"),e.refresh()}),e.updateModel=function(o){var n={template:"/app/components/settings/templates/dialogs/group-dialog.template.html",controller:"groupDialogController"};o.action="edit",t.set(o),t.customDialog(n).then(function(){e.refresh(),t.notify("Group updated.")},function(){})},e.deleteModel=function(o){var n={};n.title="Delete",n.message="Delete "+o.name+"?",n.ok="Delete",n.cancel="Cancel",t.confirm(n).then(function(){t["delete"]("/group/"+o.id).success(function(){e.refresh(),t.notify("Group deleted.")}).error(function(){t.error()})},function(){})};var o=function(t){t.deleted_at=t.deleted_at?new Date(t.deleted_at):null,t.users_count&&(t.hideDelete=!0);var o={};o.display=t.name,e.toolbar.items.push(o)};e.init=function(n){e.model={},e.model.items=[],e.toolbar.items=[],e.model.page=2,t.post("/group/enlist",n).success(function(r){e.model.details=r,e.model.items=r.data,e.model.show=!0,e.fab.show=!0,r.data.length&&angular.forEach(r.data,function(e){o(e)}),e.model.paginateLoad=function(){return e.model.busy||e.model.page>e.model.details.last_page?void(e.isLoading=!1):(e.model.busy=!0,e.isLoading=!0,void t.post("/group/enlist?page="+e.model.page,n).success(function(t){e.model.page++,angular.forEach(t.data,function(t,n){o(t),e.model.items.push(t)}),e.model.busy=!1,e.isLoading=!1}))}})},e.refresh=function(){e.isLoading=!0,e.model.show=!1,e.init(e.request)},e.request={},e.request.withTrashed=!0,e.request.paginate=20,e.request.withCount=[{relation:"users",withTrashed:!1}],e.isLoading=!0,e.$broadcast("close"),e.init(e.request)}]),app.controller("linksContentContainerController",["$scope","Helper",function(e,t){e.$emit("closeSidenav"),e.toolbar={},e.toolbar.toggleActive=function(){e.showInactive=!e.showInactive},e.toolbar.sortBy=function(t){t.sortReverse=!t.sortReverse,e.sortType=t.type,e.sortReverse=t.sortReverse},e.fab={},e.fab.icon="mdi-plus",e.fab.label="Links",e.fab.action=function(){var o={template:"/app/components/settings/templates/dialogs/link-dialog.template.html",controller:"linkDialogController"};o.action="create",t.set(o),t.customDialog(o).then(function(){t.notify("Link created."),e.refresh()},function(){})},e.$on("search",function(){e.showInactive=!0,e.request.search=e.toolbar.searchText,e.refresh()}),e.$on("refresh",function(){e.showInactive=!1,e.request.search=null,e.$broadcast("close"),e.refresh()}),e.updateModel=function(o){var n={template:"/app/components/settings/templates/dialogs/link-dialog.template.html",controller:"linkDialogController"};o.action="edit",t.set(o),t.customDialog(n).then(function(){e.refresh(),t.notify("Link updated.")},function(){})},e.deleteModel=function(o){var n={};n.title="Delete",n.message="Delete "+o.name+"?",n.ok="Delete",n.cancel="Cancel",t.confirm(n).then(function(){t["delete"]("/link/"+o.id).success(function(){e.refresh(),t.notify("Link deleted.")}).error(function(){t.error()})},function(){})};var o=function(t){t.deleted_at=t.deleted_at?new Date(t.deleted_at):null;var o={};o.display=t.name,e.toolbar.items.push(o)};e.init=function(n){e.model={},e.model.items=[],e.toolbar.items=[],e.model.page=2,t.post("/link/enlist",n).success(function(r){e.model.details=r,e.model.items=r.data,e.model.show=!0,e.fab.show=!0,r.data.length&&angular.forEach(r.data,function(e){o(e)}),e.model.paginateLoad=function(){return e.model.busy||e.model.page>e.model.details.last_page?void(e.isLoading=!1):(e.model.busy=!0,e.isLoading=!0,void t.post("/link/enlist?page="+e.model.page,n).success(function(t){e.model.page++,angular.forEach(t.data,function(t,n){o(t),e.model.items.push(t)}),e.model.busy=!1,e.isLoading=!1}))}})},e.refresh=function(){e.isLoading=!0,e.model.show=!1,e.init(e.request),e.$emit("fetchLinks")},e.request={},e.request.withTrashed=!0,e.request.paginate=20,e.request.withCount=[{relation:"users",withTrashed:!1}],e.isLoading=!0,e.$broadcast("close"),e.init(e.request)}]),app.controller("locationsContentContainerController",["$scope","Helper",function(e,t){e.$emit("closeSidenav"),e.toolbar={},e.toolbar.toggleActive=function(){e.showInactive=!e.showInactive},e.toolbar.sortBy=function(t){t.sortReverse=!t.sortReverse,e.sortType=t.type,e.sortReverse=t.sortReverse},e.fab={},e.fab.icon="mdi-plus",e.fab.label="Locations",e.fab.action=function(){var o={template:"/app/components/settings/templates/dialogs/location-dialog.template.html",controller:"locationDialogController"};o.action="create",t.set(o),t.customDialog(o).then(function(){t.notify("Location created."),e.refresh()},function(){})},e.$on("search",function(){e.showInactive=!0,e.request.search=e.toolbar.searchText,e.refresh()}),e.$on("refresh",function(){e.showInactive=!1,e.request.search=null,e.$broadcast("close"),e.refresh()}),e.updateModel=function(o){var n={template:"/app/components/settings/templates/dialogs/location-dialog.template.html",controller:"locationDialogController"};o.action="edit",t.set(o),t.customDialog(n).then(function(){e.refresh(),t.notify("Location updated.")},function(){})},e.deleteModel=function(o){var n={};n.title="Delete",n.message="Delete "+o.name+"?",n.ok="Delete",n.cancel="Cancel",t.confirm(n).then(function(){t["delete"]("/location/"+o.id).success(function(){e.refresh(),t.notify("Location deleted.")}).error(function(){t.error()})},function(){})};var o=function(t){t.deleted_at=t.deleted_at?new Date(t.deleted_at):null;var o={};o.display=t.name,e.toolbar.items.push(o)};e.init=function(n){e.model={},e.model.items=[],e.toolbar.items=[],e.model.page=2,t.post("/location/enlist",n).success(function(r){e.model.details=r,e.model.items=r.data,e.model.show=!0,e.fab.show=!0,r.data.length&&angular.forEach(r.data,function(e){o(e)}),e.model.paginateLoad=function(){return e.model.busy||e.model.page>e.model.details.last_page?void(e.isLoading=!1):(e.model.busy=!0,e.isLoading=!0,void t.post("/location/enlist?page="+e.model.page,n).success(function(t){e.model.page++,angular.forEach(t.data,function(t,n){o(t),e.model.items.push(t)}),e.model.busy=!1,e.isLoading=!1}))}})},e.refresh=function(){e.isLoading=!0,e.model.show=!1,e.init(e.request)},e.request={},e.request.withTrashed=!0,e.request.paginate=20,e.isLoading=!0,e.$broadcast("close"),e.init(e.request)}]),app.controller("uploadContentContainerController",["$scope","$filter","$state","FileUploader","Helper",function(e,t,o,n,r){e.toolbar={},e.form={},e.toolbar.items=[],e.toolbar.childState="Upload",e.toolbar.getItems=function(o){e.showInactive=!0;var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.showSearchBar=function(){e.searchBar=!0},e.hideSearchBar=function(){e.toolbar.searchText="",e.toolbar.searchItem="",
e.searchBar=!1},e.fab={},e.fab.icon="mdi-check",e.fab.label="Upload";var a={};a.filter={name:"excelFilter",fn:function(e,t){var o="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|vnd.openxmlformats-officedocument.spreadsheetml.sheet|vnd.ms-excel|".indexOf(o)!==-1}},a.error=function(t,o,n){e.fileError=!0,e.excelUploader.queue=[]},a.headers={"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},e.excelUploader=new n({url:"/upload",headers:a.headers,queueLimit:1}),e.excelUploader.filters.push(a.filter),e.excelUploader.onWhenAddingFileFailed=a.error,e.excelUploader.onAfterAddingFile=function(){e.fileError=!1,e.excelUploader.queue.length&&e.excelUploader.uploadAll()},e.checkDuplicate=function(t){var o=!0,n=e.employees.indexOf(t),a=!1;return angular.forEach(e.employees,function(e,r){o&&r!=n&&t.employee_number==e.employee_number&&(a=!0,o=!1)}),a?t.duplicate=!0:(t.duplicate=!1,void r.post("/birthday/check-duplicate",t).success(function(e){t.duplicate=e}))},e.remove=function(t){var o={title:"Remove",message:"Remove "+t.full_name+" from the list?",ok:"Remove",cancel:"Cancel"};r.confirm(o).then(function(){var o=e.employees.indexOf(t);e.employees.splice(o,1)},function(){})};var i=function(t){angular.forEach(t,function(o,n){o.birthdate=new Date(o.birthdate);var r=!0;angular.forEach(t,function(e,t){r&&n!=t&&o.employee_number==e.employee_number&&(o.duplicate=!0,r=!1)}),e.employees.push(o);var a={};a.display=o.full_name,e.toolbar.items.push(a)})};e.excelUploader.onSuccessItem=function(t,o){e.employees=[],Array.isArray(o[0])?angular.forEach(o,function(t){angular.forEach(t,function(t){e.employees.push(t)})}):angular.forEach(o,function(t){e.employees.push(t)}),r.post("/birthday/check-duplicate-multiple",e.employees).success(function(t){i(t),e.employees=t,e.show=!0}).error(function(){r.error()}),e.fab.show=!0};var s=!1;e.fab.action=function(){var t=!1;return e.form.employeeForm.$invalid?void angular.forEach(e.form.employeeForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):(angular.forEach(e.employees,function(e){if(e.duplicate)return r.alert("Duplicate Employee",e.employee_number+" already exists."),void(t=!0)}),void(s||t||(s=!0,r.preload(),angular.forEach(e.employees,function(e){e.birthdate=e.birthdate.toLocaleDateString()}),r.post("/birthday/store-multiple",e.employees).success(function(e){s=!1,r.stop(),o.go("main.birthdays")}).error(function(){angular.forEach(e.employees,function(e){e.birthdate=new Date(e.birthdate)}),r.error(),s=!1}))))}}]),app.controller("usersContentContainerController",["$scope","$state","Helper",function(e,t,o){e.$emit("closeSidenav"),e.state=t.current.name,e.toolbar={},e.toolbar.toggleActive=function(){e.showInactive=!e.showInactive},e.toolbar.sortBy=function(t){t.sortReverse=!t.sortReverse,e.sortType=t.type,e.sortReverse=t.sortReverse},e.fab={},e.fab.icon="mdi-plus",e.fab.label="Users",e.fab.action=function(){var t={template:"/app/components/settings/templates/dialogs/user-dialog.template.html",controller:"userDialogController"};t.action="create",o.set(t),o.customDialog(t).then(function(){o.notify("User created."),e.refresh()},function(){})},e.$on("search",function(){e.showInactive=!0,e.request.search=e.toolbar.searchText,e.refresh()}),e.$on("refresh",function(){e.showInactive=!1,e.request.search=null,e.$broadcast("close"),e.refresh()}),e.updateModel=function(t){var n={template:"/app/components/settings/templates/dialogs/user-dialog.template.html",controller:"userDialogController"};t.action="edit",o.set(t),o.customDialog(n).then(function(){e.refresh(),o.notify("User updated.")},function(){})},e.resetPassword=function(t){var n={};n.title="Reset Password",n.message='Password will be reset to "!welcome10"',n.ok="Reset Password",n.cancel="Cancel",o.confirm(n).then(function(){o.post("/user/reset-password",t).success(function(){e.refresh(),o.notify("Reset password succesful.")}).error(function(){o.error()})},function(){})},e.deleteModel=function(t){var n={};n.title="Delete",n.message="Delete "+t.name+"?",n.ok="Delete",n.cancel="Cancel",o.confirm(n).then(function(){o["delete"]("/user/"+t.id).success(function(){e.refresh(),o.notify("User deleted.")}).error(function(){o.error()})},function(){})};var n=function(t){t.deleted_at=t.deleted_at?new Date(t.deleted_at):null;var o={};o.display=t.name,e.toolbar.items.push(o)};e.init=function(t){e.model={},e.model.items=[],e.toolbar.items=[],e.model.page=2,o.post("/user/enlist",t).success(function(r){e.model.details=r,e.model.items=r.data,e.model.show=!0,e.fab.show=!0,r.data.length&&angular.forEach(r.data,function(e){n(e)}),e.model.paginateLoad=function(){return e.model.busy||e.model.page>e.model.details.last_page?void(e.isLoading=!1):(e.model.busy=!0,e.isLoading=!0,void o.post("/user/enlist?page="+e.model.page,t).success(function(t){e.model.page++,angular.forEach(t.data,function(t,o){n(t),e.model.items.push(t)}),e.model.busy=!1,e.isLoading=!1}))}})},e.refresh=function(){e.isLoading=!0,e.model.show=!1,e.init(e.request)},e.request={},e.request.withTrashed=!0,e.request.paginate=20,e.request["with"]=[{relation:"group",withTrashed:!1},{relation:"roles",withTrashed:!1}],e.request.where=[{label:"super_admin",condition:"!=",value:!0}],e.request.do_not_include_current_user=!0,e.isLoading=!0,e.$broadcast("close"),e.init(e.request)}]),app.controller("postsContentContainerController",["$scope","$stateParams","$state","Helper",function(e,t,o,n){e.$emit("closeSidenav"),e.today=new Date,e.viewReposts=function(e){var t={template:"/app/components/posts/templates/dialogs/reposts-dialog.template.html",controller:"repostsDialogController"};n.set(e),n.customDialog(t)},e.fetchComments=function(e){if(!e.comments){var t={};t.where=[{label:"post_id",condition:"=",value:e.id}],t["with"]=[{relation:"user",withTrashed:!0}],t.paginate=10,n.post("/comment/enlist",t).success(function(t){e.comment_details=t,e.comments=[],angular.forEach(t.data,function(t){t.created_at=new Date(t.created_at),t.updated_at=new Date(t.updated_at),e.comments.unshift(t)})})}},e.previousComments=function(e){var t=e.comment_details.current_page+1;if(t<=e.comment_details.last_page){var o={};o.where=[{label:"post_id",condition:"=",value:e.id}],o["with"]=[{relation:"user",withTrashed:!0}],o.paginate=10,n.post("/comment/enlist?page="+t,o).success(function(t){e.comment_details=t,angular.forEach(t.data,function(t){t.created_at=new Date(t.created_at),t.updated_at=new Date(t.updated_at),e.comments.unshift(t)})})}},e.repost=function(t){if(t.repost_id){var o={template:"/app/components/posts/templates/dialogs/repost-dialog.template.html",controller:"repostDialogController"};t.repost.post.action="create",n.set(t.repost.post),n.customDialog(o).then(function(){n.notify("Repost successful."),e.refresh()},function(){})}else{var o={template:"/app/components/posts/templates/dialogs/repost-dialog.template.html",controller:"repostDialogController"};t.action="create",n.set(t),n.customDialog(o).then(function(){n.notify("Repost successful."),e.refresh()},function(){})}},e.commentSection=function(t){angular.element("#comment-"+t.id).trigger("focus"),e.fetchComments(t)},e.submit=function(t){e.busy=!0,t.new_comment&&(e.fetchComments(t),n.post("/comment",t).success(function(o){t.error=!1,o.created_at=new Date(o.created_at),t.comments_count+=1,t.comments.push(o),t.new_comment=null,e.busy=!1}).error(function(){e.busy=!1,t.error=!0}))},e.toolbar={},e.fab={},e.fab.icon="mdi-message-text",e.fab.label="Post",e.fab.action=function(){var t={template:"/app/components/posts/templates/dialogs/post-dialog.template.html",controller:"postDialogController"};t.action="create",n.set(t),n.customDialog(t).then(function(){n.notify("Post created."),e.refresh()},function(){})},e.$on("search",function(){e.request.search=e.toolbar.searchText,e.refresh()}),e.$on("refresh",function(){e.request.search=null,e.$broadcast("close"),e.refresh()}),e.$on("read-post",function(){e.request.where=[{label:"id",condition:"=",value:n.fetch()}],e.isLoading=!0,e.post.show=!1,e.currentTime=Date.now(),e.init(e.request)}),e.$on("read-post-and-comments",function(){e.request.where=[{label:"id",condition:"=",value:n.fetch()}],e.isLoading=!0,e.post.show=!1,e.currentTime=Date.now(),e.init(e.request,!0)}),e.updatePost=function(t){if(t.repost_id){var o={template:"/app/components/posts/templates/dialogs/repost-dialog.template.html",controller:"repostDialogController"};t.action="edit",n.set(t),n.customDialog(o).then(function(){n.notify("Repost updated."),e.refresh()},function(){})}else{var o={template:"/app/components/posts/templates/dialogs/post-dialog.template.html",controller:"postDialogController"};t.action="edit",n.set(t),n.customDialog(o).then(function(){e.refresh(),n.notify("Post updated.")},function(){})}},e.deletePost=function(t){var o={};o.title="Delete",o.message="Delete this post?",o.ok="Delete",o.cancel="Cancel",n.confirm(o).then(function(){n["delete"]("/post/"+t.id).success(function(){e.refresh(),n.notify("Post deleted.")}).error(function(){n.error()})},function(){})},e.editComment=function(e,t){angular.forEach(t.comments,function(e){e.edit=!1}),e.edit=!0,e.new_message=e.message},e.updateComment=function(t){e.busy=!0,n.put("/comment/"+t.id,t).success(function(o){o.updated_at=new Date(o.updated_at),t.message=o.message,t.error=!1,t.edit=!1,e.busy=!1,n.notify("Comment updated.")}).error(function(){e.busy=!1,t.error=!0})},e.deleteComment=function(e,t){var o={};o.title="Delete",o.message="Delete this comment?",o.ok="Delete",o.cancel="Cancel",n.confirm(o).then(function(){n["delete"]("/comment/"+e.id).success(function(){var o=t.comments.indexOf(e);t.comments.splice(o,1),t.comments_count--,n.notify("Comment deleted.")}).error(function(){n.error()})},function(){})};var r=function(t){t.created_at=new Date(t.created_at),t.repost_id&&(t.repost.post.created_at=new Date(t.repost.post.created_at),t.repost.post.chips=[],angular.forEach(t.repost.post.hashtags,function(e){t.repost.post.chips.push(e.tag)})),t.chips=[],angular.forEach(t.hashtags,function(e){t.chips.push(e.tag)});var o={};o.display=t.title,e.toolbar.items.push(o)};e.searchHashTag=function(t){e.toolbar.searchText=t,e.$broadcast("open")};var a={whereMonth:{label:"birthdate",value:(new Date).getMonth()+1},whereDay:{label:"birthdate",value:(new Date).getDate()}};n.post("/birthday/enlist",a).success(function(t){e.birthdays=t}),e.init=function(t,o){e.post={},e.post.items=[],e.toolbar.items=[],e.post.page=2,n.post("/user/check").success(function(a){angular.forEach(a.roles,function(e){"posts"==e.name&&(a.can_post=!0)}),e.current_user=a,n.post("/post/enlist",t).success(function(a){e.post.details=a,e.post.items=a.data,e.post.show=!0,e.fab.show=!!e.current_user.can_post,a.data.length&&angular.forEach(a.data,function(t){r(t),o&&e.fetchComments(t)}),e.post.paginateLoad=function(){return e.post.busy||e.post.page>e.post.details.last_page?void(e.isLoading=!1):(e.post.busy=!0,e.isLoading=!0,void n.post("/post/enlist?page="+e.post.page,t).success(function(t){e.post.page++,angular.forEach(t.data,function(t,o){r(t),e.post.items.push(t)}),e.post.busy=!1,e.isLoading=!1}))}})})},e.refresh=function(){t.postID?o.go("main.posts",{postID:null}):(e.isLoading=!0,e.post.show=!1,e.currentTime=Date.now(),e.request.where=null,e.init(e.request))},e.request={},e.request.withTrashed=!1,e.request.paginate=10,e.request["with"]=[{relation:"user",withTrashed:!0},{relation:"hashtags",withTrashed:!1},{relation:"group",withTrashed:!0},{relation:"repost.post",withTrashed:!1}],e.request.withCount=[{relation:"comments",withTrashed:!1},{relation:"reposts",withTrashed:!1}],e.request.orderBy=[{column:"updated_at",order:"desc"}],t.postID&&(e.request.where=[{label:"id",condition:"=",value:t.postID}]),e.isLoading=!0,e.$broadcast("close"),e.init(e.request)}]),app.controller("homeContentContainerController",["$scope","$state","Helper",function(e,t,o){e.$emit("closeSidenav"),e.toolbar={},e.fab={},e.fab.icon="mdi-presentation",e.fab.label="New",e.fab.action=function(){t.go("main.slideshow",{slideshowID:null})},e.edit=function(e){t.go("main.slideshow",{slideshowID:e})},e.init=function(){var t={};t["with"]=[{relation:"slides",withTrashed:!1}],t.first=!0,o.post("/user/check").success(function(t){angular.forEach(t.roles,function(o){"slideshow"==o.name&&(t.can_slide=!0,e.fab.show=!0)}),e.current_user=t}),o.post("/slideshow/enlist",t).success(function(t){e.slideshow=t})}()}]),app.controller("slideshowContentContainerController",["$scope","$state","$stateParams","FileUploader","Helper",function(e,t,o,n,r){if(e.toolbar={},e.action="create",e.form={},e.slideshow={},e.slideshow.slides=[],o.slideshowID){e.action="edit";var a={"with":[{relation:"slides",withTrashed:!1}],where:[{label:"id",condition:"=",value:o.slideshowID}],first:!0};r.post("/slideshow/enlist",a).success(function(t){e.slideshow=t,e.show=!0,e.fab.show=!0,e.fab.icon="mdi-check",e.fab.label="Save Changes"})}e.fab={},e.fab.icon="mdi-upload",e.fab.label="Upload",e.fab.action=function(){return e.form.slidesForm.$invalid?void angular.forEach(e.form.slidesForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):(r.preload(),angular.forEach(e.slideshow.slides,function(e,t){e.order=t}),void(o.slideshowID?r.put("/slideshow/"+o.slideshowID,e.slideshow).success(function(){r.stop(),r.notify("Changes saved."),t.go("main")}).error(function(){r.error()}):r.post("/slideshow",e.slideshow).success(function(){r.stop(),r.notify("Upload successfuly."),t.go("main")}).error(function(){r.error()})))};var i={};i.filter={name:"photoFilter",fn:function(e,t){var o="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(o)!==-1}},i.sizeFilter={name:"enforceMaxFileSize",fn:function(e){return e.size<=10485760}},i.error=function(t,o,n){e.fileError=!0,e.photoUploader.queue=[]},i.headers={"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},e.slideUploader=function(){angular.element("#slides").trigger("click")},e.photoUploader=new n({url:"/temp-upload/upload-photo",headers:i.headers}),e.photoUploader.filters.push(i.filter),e.photoUploader.filters.push(i.sizeFilter),e.photoUploader.onWhenAddingFileFailed=i.error,e.photoUploader.onAfterAddingFile=function(){e.fileError=!1,e.photoUploader.queue.length&&angular.forEach(e.photoUploader.queue,function(t,o){e.photoUploader.uploadItem(o)})},e.photoUploader.onCompleteItem=function(t,o){o["new"]=!0,e.slideshow.slides.push(o)},e.photoUploader.onErrorItem=function(){r.error()},e.photoUploader.onCompleteAll=function(){e.show=!0,e.fab.show=!0,e.photoUploader.queue=[]},e.moveUp=function(t){var o=e.slideshow.slides.indexOf(t);e.slideshow.slides.splice(o,1),e.slideshow.slides.splice(o-1,0,t)},e.moveDown=function(t){var o=e.slideshow.slides.indexOf(t);e.slideshow.slides.splice(o,1),e.slideshow.slides.splice(o+1,0,t)},e["delete"]=function(t){var o={title:"Delete",message:"This image will be deleted permanently.",ok:"Delete",cancel:"Cancel"},n=e.slideshow.slides.indexOf(t);r.confirm(o).then(function(){t["new"]?r.post("/temp-upload/delete-slide",t).success(function(){r.notify("Photo deleted."),e.slideshow.slides.splice(n,1)}).error(function(){r.error()}):r["delete"]("/slide/"+t.id).success(function(){r.notify("Photo deleted."),e.slideshow.slides.splice(n,1)}).error(function(){r.error()})},function(){})}}]),app.controller("homeToolbarController",["$scope","Helper",function(e,t){e.toolbar.childState="Home",e.toolbar.hideSearchIcon=!0}]),app.controller("slideshowToolbarController",["$scope","$stateParams","Helper",function(e,t,o){e.toolbar.parentState="Slideshow",t.slideshowID?e.toolbar.childState="Edit":e.toolbar.childState="New",e.toolbar.hideSearchIcon=!0}]),app.controller("approvalsContentContainerController",["$scope","$state","$stateParams","Helper",function(e,t,o,n){e.$emit("closeSidenav"),e.toolbar={},e.toolbar.sortBy=function(t){t.sortReverse=!t.sortReverse,e.sortType=t.type,e.sortReverse=t.sortReverse},e.subheader={},e.subheader.show=!0,e.subheader.current={},e.subheader.mark={},e.subheader.toggleMark=function(){e.subheader.mark.all=!e.subheader.mark.all,e.subheader.mark.icon=e.subheader.mark.all?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",e.subheader.mark.label=e.subheader.mark.all?"Uncheck all":"Check all",angular.forEach(e.reservation.items,function(t){t.include=e.subheader.mark.all})},e.subheader.cancelSelectMultiple=function(){e.selectMultiple=!1,e.fab.show=!1,e.subheader.mark.all=!1,e.subheader.mark.icon="mdi-checkbox-blank-outline",e.subheader.mark.label="Check all",angular.forEach(e.reservation.items,function(e){e.include=!1})},e.fab={},e.fab.icon="mdi-check",e.viewReservation=function(t){n.set(t);var o={template:"/app/components/approvals/templates/dialogs/approval-dialog.template.html",controller:"approvalDialogController"};n.customDialog(o).then(function(t){t?n.notify("Reservation disapproved."):n.notify("Reservation approved."),e.refresh()},function(){})},e.$on("setInit",function(){e.isLoading=!0,e.$broadcast("close");var t=n.fetch();e.subheader.current=t,e.init(t)}),e.$on("search",function(){e.subheader.current.request.search=e.toolbar.searchText,e.refresh()}),e.$on("refresh",function(){e.subheader.current.request.search=null,e.$broadcast("close"),e.refresh()}),e.$on("selectMultiple",function(){e.selectMultiple=!0}),e.$on("cancelSelectMultiple",function(){e.subheader.cancelSelectMultiple()}),e.$on("read-approval",function(){e.subheader.current.request.where.push({label:"id",condition:"=",value:n.fetch()}),e.isLoading=!0,e.reservation.show=!1,e.init(e.subheader.current)});var r=function(t){t.deleted_at=t.deleted_at?new Date(t.deleted_at):null,t.created_at=new Date(t.created_at),t.start=new Date(t.start),t.end=new Date(t.end);var o={};o.display=t.title,e.toolbar.items.push(o)};e.init=function(t){e.subheader.mark.all=!1,e.subheader.mark.icon="mdi-checkbox-blank-outline",e.subheader.mark.label="Check all",e.toolbar.items=[],e.reservation={},e.reservation.items=[],e.reservation.show=!0,e.reservation.page=2,n.post("/reservation/enlist",t.request).success(function(o){e.reservation.details=o,e.reservation.items=[],o.data.length&&angular.forEach(o.data,function(t){r(t),e.reservation.items.push(t)}),e.isLoading=!1,e.reservation.paginateLoad=function(){return e.reservation.busy||e.reservation.page>e.reservation.details.last_page?void(e.isLoading=!1):(e.reservation.busy=!0,e.isLoading=!0,void n.post("/reservation/enlist?page="+e.reservation.page,t.request).success(function(t){e.reservation.page++,angular.forEach(t.data,function(t,o){r(t),e.reservation.items.push(t)}),e.reservation.busy=!1,e.isLoading=!1}))}})},e.refresh=function(){e.isLoading=!0,e.reservation.show=!1,e.init(e.subheader.current),t.go("main.approvals",{reservationID:null})}}]),app.controller("approvalDialogController",["$scope","Helper",function(e,t){var o=t.fetch();t.post("/user/check").success(function(t){e.approver=t}),e.cancel=function(){t.cancel()},e.checkDuplicate=function(o){t.post("/reservation-equipment/check-duplicate",o).success(function(t){e.duplicate=t,o.duplicate=t})};var n={"with":[{relation:"location",withTrashed:!0},{relation:"user",withTrashed:!0},{relation:"equipment_types",withTrashed:!1,available_units:!0},{relation:"schedule_approver",withTrashed:!0},{relation:"equipment_approver",withTrashed:!0}],where:[{label:"id",condition:"=",value:o.id}],first:!0};t.post("/reservation/enlist",n).success(function(t){e.start=new Date(t.start),e.end=t.end?new Date(t.end):null,e.reservation=t}).error(function(){t.error()}),e.submit=function(){return e.approvalForm.$invalid?void angular.forEach(e.approvalForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):(e.duplicate=!1,e.duplicate||(e.busy=!0,1==e.approver.group_id&&t.post("/reservation-equipment/approve",e.reservation.equipment_types).success(function(o){o?(e.duplicate=!0,e.busy=!1):t.stop()}).error(function(){e.busy=!1,e.error=!0})),void(2==e.approver.group_id&&t.post("/reservation/approve",e.reservation).success(function(o){o?(e.duplicate=!0,e.busy=!1):t.stop()}).error(function(){e.busy=!1,e.error=!0})))},e.disapprove=function(){2==e.approver.group_id&&(e.busy=!0,t.post("/reservation/reschedule",e.reservation).success(function(){t.stop(!0)}).error(function(){e.busy=!1,e.error=!0}))}}]),app.controller("approvalsSubheaderController",["$scope","Helper",function(e,t){var o=function(o){t.set(o),e.current_tab=o,e.$emit("setInit")};(new Date).toDateString();e.subheader.all={},e.subheader.all.label="All",e.subheader.all.request={"with":[{relation:"location",withTrashed:!0},{relation:"user",withTrashed:!0},{relation:"schedule_approver",withTrashed:!0},{relation:"equipment_approver",withTrashed:!0}],where:[],approvals:!0,paginate:10},e.subheader.all.action=function(){o(e.subheader.all)},e.init=function(){t.get("/location").success(function(t){e.locations=t,e.subheader.navs=[],angular.forEach(e.locations,function(t){var n={};n.id=t.id,n.label=t.name,n.request={"with":[{relation:"location",withTrashed:!0},{relation:"user",withTrashed:!0},{relation:"schedule_approver",withTrashed:!0},{relation:"equipment_approver",withTrashed:!0}],where:[{label:"location_id",condition:"=",value:t.id}],approvals:!0,paginate:10},n.menu=e.subheader.all.menu,n.action=function(e){o(e)},e.subheader.navs.push(n)}),o(e.subheader.all)})},e.init()}]),app.controller("approvalsToolbarController",["$scope","$filter",function(e,t){e.toolbar.childState="Approvals",e.$on("close",function(){e.hideSearchBar()}),e.$on("open",function(){e.showSearchBar(),e.searchUserInput()}),e.toolbar.getItems=function(o){var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.reservation.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.sort=[{label:"Title",type:"title",sortReverse:!1},{label:"Remarks",type:"remarks",sortReverse:!1},{label:"Date Start",type:"start",sortReverse:!1},{label:"Date End",type:"end",sortReverse:!1},{label:"Recently added",type:"created_at",sortReverse:!1}],e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("notificationsContentContainerController",["$scope","$state","Helper",function(e,t,o){e.$emit("closeSidenav"),e.toolbar={},e.$on("search",function(){e.request.search=e.toolbar.searchText,e.refresh()}),e.$on("refresh",function(){e.request.search=null,e.$broadcast("close"),e.refresh()});var n=function(t){var t={display:t.data.sender.name,message:t.data.message};e.toolbar.items.push(t)};e.readNotification=function(n){n.data.withParams?t.go(n.data.url,{id:n.data.attachment.id}):(t.go(n.data.url),"App\\Notifications\\PostCreated"==n.type||"App\\Notifications\\RepostCreated"==n.type?(o.set(n.data.attachment.id),e.$broadcast("read-post")):"App\\Notifications\\CommentCreated"==n.type?(o.set(n.data.attachment.post_id),e.$broadcast("read-post-and-comments")):"App\\Notifications\\ReservationCreated"==n.type&&(o.set(n.data.attachment.id),e.$broadcast("read-approval")))},e.init=function(t){e.notification={},e.notification.items=[],e.toolbar.items=[],e.notification.page=2,o.post("/user/notifications",t).success(function(r){e.notification.details=r,e.notification.items=r.data,e.notification.show=!0,r.data.length&&angular.forEach(r.data,function(e){n(e)}),e.notification.paginateLoad=function(){return e.notification.busy||e.notification.page>e.notification.details.last_page?void(e.isLoading=!1):(e.notification.busy=!0,e.isLoading=!0,void o.post("/user/notifications?page="+e.notification.page,t).success(function(t){e.notification.page++,angular.forEach(t.data,function(t,o){n(t),e.notification.items.push(t)}),e.notification.busy=!1,e.isLoading=!1}))}})},e.refresh=function(){e.isLoading=!0,e.notification.show=!1,e.request.where=null,e.init(e.request)},e.request={paginate:20},e.init(e.request)}]),app.controller("notificationsToolbarController",["$scope","$filter",function(e,t){e.toolbar.childState="Notifications",e.$on("close",function(){e.hideSearchBar()}),e.$on("open",function(){e.showSearchBar(),e.searchUserInput()}),e.toolbar.getItems=function(o){var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.notification.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("approvedReservationDialogController",["$scope","Helper",function(e,t){var o=t.fetch();e.cancel=function(){t.cancel()};var n={"with":[{relation:"location",withTrashed:!0},{relation:"user",withTrashed:!0},{relation:"equipment_types",withTrashed:!1},{relation:"equipment",withTrashed:!0},{relation:"schedule_approver",withTrashed:!0},{relation:"equipment_approver",withTrashed:!0}],where:[{label:"id",condition:"=",value:o.id}],first:!0};t.post("/reservation/enlist",n).success(function(t){t.start=new Date(t.start),t.end=t.end?new Date(t.end):null,e.reservation=t}).error(function(){t.error()})}]),app.controller("reservationDialogController",["$scope","Helper",function(e,t){e.config=t.fetch(),e.cancel=function(){t.cancel()},e.repetitions=["Daily","Weekly","Monthly"],e.duplicate=!1,e.fallback={},e.reservation={},e.reservation.equipment_types=[],e.current=new Date;var o=function(e){e.getMinutes()<30?e.setMinutes(30):e.getMinutes()>30&&(e.setHours(e.getHours()+1),e.setMinutes(0)),e.setSeconds(0)};o(e.current),e.reservation.date_start=new Date,e.reservation.time_start=e.current,e.reservation.date_end=new Date,e.reservation.time_end=e.current;var n=function(){e.fallback.date_start=new Date(e.reservation.date_start),e.fallback.date_end=new Date(e.reservation.date_end),e.fallback.time_start=new Date(e.reservation.time_start),e.fallback.time_end=new Date(e.reservation.time_end),e.fallback.until=e.reservation.until?new Date(e.reservation.until):null},r=function(){e.reservation.date_start=new Date(e.fallback.date_start),e.reservation.date_end=new Date(e.fallback.date_end),e.reservation.time_start=new Date(e.fallback.time_start),e.reservation.time_end=new Date(e.fallback.time_end),e.reservation.until=e.fallback.until?new Date(e.fallback.until):null};if(e.floorParticipants=function(){e.reservation.participants=Math.floor(e.reservation.participants)},e.setUntil=function(){e.reservation.until=new Date},e.setRepeat=function(){e.repeat||(e.reservation.repeat=null,e.reservation.until=null)},e.checkDuplicate=function(){if(e.reservation.location_id){var o={};o.location_id=e.reservation.location_id,o.date_start=new Date(e.reservation.date_start).toDateString(),o.date_end=new Date(e.reservation.date_end).toDateString(),o.time_start=new Date(e.reservation.time_start).toLocaleTimeString(),o.time_end=new Date(e.reservation.time_end).toLocaleTimeString(),e.reservation.until&&(o.repeat=e.reservation.repeat,o.until=new Date(e.reservation.until).toDateString()),e.reservation.id&&(o.id=e.reservation.id),t.post("/reservation/check-duplicate",o).success(function(t){e.duplicate=t})}},e.locationChange=function(){e.checkDuplicate()},e.setDateStart=function(){e.reservation.time_start.setMonth(e.reservation.date_start.getMonth()),e.reservation.time_start.setDate(e.reservation.date_start.getDate()),e.reservation.time_start.setFullYear(e.reservation.date_start.getFullYear()),e.reservation.time_start=new Date(e.reservation.time_start),e.min_end_time=new Date(e.reservation.time_start),e.min_end_time>=e.reservation.time_end&&(e.reservation.time_end=new Date(e.min_end_time)),e.reservation.time_start>e.reservation.time_end&&(e.reservation.time_end=new Date(e.reservation.time_start)),e.reservation.date_start>e.reservation.date_end&&(e.reservation.date_end=new Date(e.reservation.date_start)),e.checkDuplicate()},e.setDateEnd=function(){e.reservation.time_end.setMonth(e.reservation.date_end.getMonth()),e.reservation.time_end.setDate(e.reservation.date_end.getDate()),e.reservation.time_end.setFullYear(e.reservation.date_end.getFullYear()),e.reservation.time_end=new Date(e.reservation.time_end),e.reservation.until=new Date(e.reservation.time_end),e.reservation.time_start>e.reservation.time_end&&(e.reservation.time_end=new Date(e.reservation.time_start)),e.checkDuplicate()},e.timeStartChanged=function(){e.min_end_time=new Date(e.reservation.time_start),e.reservation.time_start>e.reservation.time_end&&(e.reservation.time_end=new Date(e.reservation.time_start)),e.checkEquipment(e.reservation.time_start,e.reservation.time_end),e.checkDuplicate()},e.timeEndChanged=function(){e.checkDuplicate(),e.checkEquipment(e.reservation.time_start,e.reservation.time_end)},e.allDay=function(){e.reservation.allDay?(e.reservation.time_start.setHours(0,0,0,0),e.reservation.time_start=new Date(e.reservation.time_start),e.reservation.time_end.setHours(23,59,59),e.reservation.time_end=new Date(e.reservation.time_end)):(e.reservation.time_start=new Date,e.reservation.time_end=new Date,e.min_start_time=new Date,e.min_start_date=new Date,e.min_end_time=new Date,o(e.reservation.time_start),o(e.reservation.time_end),o(e.reservation.min_start_time),o(e.reservation.min_end_time)),e.checkDuplicate()},e.checkEquipment=function(o,n){var r={start:new Date(o).toDateString()+" "+new Date(o).toLocaleTimeString(),end:new Date(n).toDateString()+" "+new Date(n).toLocaleTimeString()},a={"with":[{relation:"equipment",withTrashed:!1,whereDoesntHave:{relation:"reservations",whereNotNull:["schedule_approver_id","equipment_approver_id"],whereBetween:{label:"start",start:r.start,end:r.end}}}]};t.post("/equipment-type/enlist",a).success(function(o){e.equipment_types=o,"edit"==e.config.action&&angular.forEach(e.equipment_types,function(o,n){e.reservation.equipment_types.push(null);var r={};r["with"]=[{relation:"equipment_type.equipment",withTrashed:!1}],r.where=[{label:"reservation_id",condition:"=",value:e.reservation.id},{label:"equipment_type_id",condition:"=",value:o.id}],r.first=!0,t.post("/reservation-equipment/enlist",r).success(function(t){t&&(e.reservation.equipment_types[n]=t.equipment_type)})})})},e.busy=!1,t.get("/location").success(function(t){e.locations=t}),"create"==e.config.action&&(e.min_start_time=new Date,e.min_start_date=new Date,e.min_end_time=new Date,e.checkEquipment(e.reservation.time_start,e.reservation.time_end)),"edit"==e.config.action){var a={where:[{label:"id",condition:"=",value:e.config.id}],first:!0};t.post("/reservation/enlist",a).success(function(t){t.start=new Date(t.start),t.end=t.end?new Date(t.end):null,e.reservation=t,e.reservation.equipment_types=[],e.reservation.allDay=!!t.allDay,e.reservation.date_start=new Date(t.start),e.reservation.date_end=new Date(t.end),e.reservation.time_start=new Date(t.start),e.reservation.time_end=new Date(t.end),e.min_start_time=new Date,e.min_start_date=new Date,e.min_end_time=new Date,e.checkEquipment(e.reservation.time_start,e.reservation.time_end)}).error(function(){t.error()})}e.submit=function(){return e.reservationForm.$invalid?void angular.forEach(e.reservationForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):void(e.duplicate||(e.busy=!0,n(),e.reservation.time_start=new Date(e.reservation.time_start).setSeconds(0),e.reservation.time_end=new Date(e.reservation.time_end).setSeconds(0),e.reservation.date_start=new Date(e.reservation.date_start).toDateString(),e.reservation.date_end=new Date(e.reservation.date_end).toDateString(),e.reservation.time_start=new Date(e.reservation.time_start).toLocaleTimeString(),e.reservation.time_end=new Date(e.reservation.time_end).toLocaleTimeString(),e.reservation.until=e.reservation.until?new Date(e.reservation.until).toDateString():null,"create"==e.config.action?t.post("/reservation",e.reservation).success(function(o){o?(e.busy=!1,e.duplicate=o,r()):t.stop()}).error(function(){e.busy=!1,
e.error=!0,r()}):"edit"==e.config.action&&t.put("/reservation/"+e.config.id,e.reservation).success(function(o){o?(e.busy=!1,e.duplicate=o,r()):t.stop()}).error(function(){e.busy=!1,e.error=!0,r()})))}}]),app.controller("reservationsSubheaderController",["$scope","Helper",function(e,t){var o=function(o){t.set(o),e.current_tab=o,e.$emit("setInit")};e.subheader.all={},e.subheader.all.label="All",e.subheader.all.fab={template:"/app/components/reservations/templates/dialogs/reservation-dialog.template.html",controller:"reservationDialogController",action:"create"},e.subheader.all.request={"with":[{relation:"location",withTrashed:!1},{relation:"user",withTrashed:!1},{relation:"schedule_approver",withTrashed:!1},{relation:"equipment_approver",withTrashed:!1}],withCount:[{relation:"equipment_types",withTrashed:!1}]},e.subheader.all.action=function(){o(e.subheader.all)},e.$on("dateRange",function(){var o=t.fetch(),n={label:"start",start:o.start,end:o.end};e.subheader.all.request.whereBetween=n,angular.forEach(e.subheader.navs,function(e){e.request.whereBetween=n})}),e.init=function(){t.get("/location").success(function(t){e.locations=t,e.subheader.navs=[],angular.forEach(e.locations,function(t){var n={};n.id=t.id,n.label=t.name,n.request={"with":[{relation:"location",withTrashed:!1},{relation:"user",withTrashed:!1},{relation:"schedule_approver",withTrashed:!1},{relation:"equipment_approver",withTrashed:!1}],withCount:[{relation:"equipment_types",withTrashed:!1}],where:[{label:"location_id",condition:"=",value:t.id}],whereBetween:{label:"start",start:e.dateRange.start,end:e.dateRange.end}},n.fab={template:"/app/components/reservations/templates/dialogs/reservation-dialog.template.html",controller:"reservationDialogController",action:"create",message:"Reservation created",location_id:t.id},n.action=function(e){o(e)},e.subheader.navs.push(n)}),o(e.subheader.all)})},e.init()}]),app.controller("reservationsToolbarController",["$scope","$filter",function(e,t){e.toolbar.childState="Room Reservations",e.$on("close",function(){e.hideSearchBar()}),e.toolbar.getItems=function(o){var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.reservation.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("birthdayDialogController",["$scope","Helper",function(e,t){e.config=t.fetch(),e.today=new Date,"create"==e.config.action?e.model={}:"edit"==e.config.action&&t.get("/birthday/"+e.config.id).success(function(t){t.birthdate=new Date(t.birthdate),e.model=t}),e.duplicate=!1,e.busy=!1,e.cancel=function(){t.cancel()},e.checkDuplicate=function(){t.post("/birthday/check-duplicate",e.model).success(function(t){e.duplicate=t})},e.submit=function(){return e.modelForm.$invalid?void angular.forEach(e.modelForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):void(e.duplicate||(e.busy=!0,e.model.birthdate=e.model.birthdate.toLocaleDateString(),"create"==e.config.action?t.post("/birthday",e.model).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0,e.model.birthdate=new Date(e.model.birthdate)}):"edit"==e.config.action&&t.put("/birthday/"+e.config.id,e.model).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0,e.model.birthdate=new Date(e.model.birthdate)})))}}]),app.controller("equipmentDialogController",["$scope","Helper",function(e,t){e.config=t.fetch(),"create"==e.config.action?(e.equipment={},e.equipment.equipment_type_id=e.config.equipment_type_id):"edit"==e.config.action&&t.get("/equipment/"+e.config.id).success(function(t){e.equipment=t}),e.duplicate=!1,e.busy=!1,e.cancel=function(){t.cancel()},e.checkDuplicate=function(){t.post("/equipment/check-duplicate",e.equipment).success(function(t){e.duplicate=t})},e.submit=function(){return e.equipmentForm.$invalid?void angular.forEach(e.equipmentForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):void(e.duplicate||(e.busy=!0,"create"==e.config.action?t.post("/equipment",e.equipment).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0}):"edit"==e.config.action&&t.put("/equipment/"+e.config.id,e.equipment).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0})))}}]),app.controller("equipmentTypeDialogController",["$scope","Helper",function(e,t){e.config=t.fetch(),"create"==e.config.action?e.equipment_type={}:"edit"==e.config.action&&t.get("/equipment-type/"+e.config.id).success(function(t){e.equipment_type=t}),e.duplicate=!1,e.busy=!1,e.cancel=function(){t.cancel()},e.checkDuplicate=function(){t.post("/equipment-type/check-duplicate",e.equipment_type).success(function(t){e.duplicate=t})},e.submit=function(){return e.equipmentTypeForm.$invalid?void angular.forEach(e.equipmentTypeForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):void(e.duplicate||(e.busy=!0,"create"==e.config.action?t.post("/equipment-type",e.equipment_type).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0}):"edit"==e.config.action&&t.put("/equipment-type/"+e.config.id,e.equipment_type).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0})))}}]),app.controller("formDialogController",["$scope","Helper","FileUploader",function(e,t,o){if(e.config=t.fetch(),e.document={},e.duplicate=!1,"edit"==e.config.action){var n={};n.where=[{label:"id",condition:"=",value:e.config.id}],n.first=!0,t.post("/form/enlist",n).success(function(t){e.document=t})}e.cancel=function(){t.cancel()},e.clickUpload=function(){angular.element("#file-upload").trigger("click")};var r={};r.filter={name:"fileTypeFilter",fn:function(e,t){var o="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|pdf|".indexOf(o)!==-1}},r.error=function(t,o,n){e.fileError=!0,e.pdfUploader.queue=[]},r.headers={"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},e.pdfUploader=new o({url:"/temp-upload/upload-file",headers:r.headers,queueLimit:1}),e.pdfUploader.filters.push(r.filter),e.pdfUploader.onWhenAddingFileFailed=r.error,e.pdfUploader.onAfterAddingFile=function(){e.fileError=!1,e.pdfUploader.queue.length&&e.pdfUploader.uploadAll()},e.pdfUploader.onCompleteItem=function(t,o){e.document.path=o},e.pdfUploader.onErrorItem=function(){e.error=!0},e.checkDuplicate=function(){t.post("/form/check-duplicate","FormController@checkDuplicate").success(function(t){e.duplicate=t})},e.submit=function(){return e.documentForm.$invalid?void angular.forEach(e.documentForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):void(e.duplicate||(e.busy=!0,"create"==e.config.action?t.post("/form",e.document).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0}):"edit"==e.config.action&&t.put("/form/"+e.config.id,e.document).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0})))}}]),app.controller("groupDialogController",["$scope","Helper",function(e,t){e.config=t.fetch(),"create"==e.config.action?e.model={}:"edit"==e.config.action&&t.get("/group/"+e.config.id).success(function(t){e.model=t}),e.duplicate=!1,e.busy=!1,e.cancel=function(){t.cancel()},e.checkDuplicate=function(){t.post("/group/check-duplicate",e.model).success(function(t){e.duplicate=t})},e.submit=function(){return e.modelForm.$invalid?void angular.forEach(e.modelForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):void(e.duplicate||(e.busy=!0,"create"==e.config.action?t.post("/group",e.model).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0}):"edit"==e.config.action&&t.put("/group/"+e.config.id,e.model).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0})))}}]),app.controller("linkDialogController",["$scope","Helper",function(e,t){e.config=t.fetch(),"create"==e.config.action?e.model={}:"edit"==e.config.action&&t.get("/link/"+e.config.id).success(function(t){e.model=t}),e.duplicate=!1,e.busy=!1,e.cancel=function(){t.cancel()},e.checkDuplicate=function(){t.post("/link/check-duplicate",e.model).success(function(t){e.duplicate=t})},e.submit=function(){return e.modelForm.$invalid?void angular.forEach(e.modelForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):void(e.duplicate||(e.busy=!0,"create"==e.config.action?t.post("/link",e.model).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0}):"edit"==e.config.action&&t.put("/link/"+e.config.id,e.model).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0})))}}]),app.controller("locationDialogController",["$scope","Helper",function(e,t){e.config=t.fetch(),"create"==e.config.action?e.model={}:"edit"==e.config.action&&t.get("/location/"+e.config.id).success(function(t){e.model=t}),e.duplicate=!1,e.busy=!1,e.cancel=function(){t.cancel()},e.checkDuplicate=function(){t.post("/location/check-duplicate",e.model).success(function(t){e.duplicate=t})},e.submit=function(){return e.modelForm.$invalid?void angular.forEach(e.modelForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):void(e.duplicate||(e.busy=!0,"create"==e.config.action?t.post("/location",e.model).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0}):"edit"==e.config.action&&t.put("/location/"+e.config.id,e.model).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0})))}}]),app.controller("userDialogController",["$scope","Helper",function(e,t){e.config=t.fetch(),t.get("/group").success(function(t){e.groups=t}),t.post("/role/enlist").success(function(t){e.roles=t}),"create"==e.config.action?(e.model={},e.model.roles=[],e.model.group_id=e.config.group_id):"edit"==e.config.action&&t.post("/role/enlist").success(function(o){e.roles=o,e.count=e.roles.length,t.get("/user/"+e.config.id).success(function(o){e.model=o,e.model.roles=[],angular.forEach(e.roles,function(o,n){e.model.roles.push(null);var r={};r["with"]=[{relation:"role",withTrashed:!1}],r.where=[{label:"user_id",condition:"=",value:e.model.id},{label:"role_id",condition:"=",value:o.id}],r.first=!0,t.post("/user-role/enlist",r).success(function(t){e.count--,t&&e.model.roles.splice(n,1,t.role)})})}).error(function(){t.error()})}),e.duplicate=!1,e.busy=!1,e.cancel=function(){t.cancel()},e.checkDuplicate=function(){t.post("/user/check-email",e.model).success(function(t){e.duplicate=t})},e.submit=function(){return e.modelForm.$invalid?void angular.forEach(e.modelForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):void(e.duplicate||(e.busy=!0,"create"==e.config.action?t.post("/user",e.model).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0}):"edit"==e.config.action&&t.put("/user/"+e.config.id,e.model).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0})))}}]),app.controller("equipmentSubheaderController",["$scope","Helper",function(e,t){var o=function(o){t.set(o),e.current_tab=o,e.$emit("setInit")};e.subheader.create=function(){var o={};o.template="/app/components/settings/templates/dialogs/equipment-type-dialog.template.html",o.controller="equipmentTypeDialogController",o.action="create",t.set(o),t.customDialog(o).then(function(){e.init(),t.notify("Equipment type created.")},function(){})},e.subheader.update=function(){var o={};o.template="/app/components/settings/templates/dialogs/equipment-type-dialog.template.html",o.controller="equipmentTypeDialogController",o.action="edit",o.id=e.current_tab.id,t.set(o),t.customDialog(o).then(function(){e.init(),t.notify("Equipment type updated.")},function(){})},e.subheader["delete"]=function(){var o={};o.title="Delete",o.message="Delete "+e.current_tab.label+"?",o.ok="Delete",o.cancel="Cancel",t.confirm(o).then(function(){t["delete"]("/equipment-type/"+e.current_tab.id).success(function(){e.init(),t.notify("Equipment type deleted.")}).error(function(){t.error()})},function(){})},e.init=function(){var n={};n.withCount=[{relation:"equipment",withTrashed:!1}],t.post("/equipment-type/enlist",n).success(function(t){e.equipment_types=t,e.subheader.navs=[],angular.forEach(e.equipment_types,function(t){var n={};n.id=t.id,n.equipment_count=t.equipment_count,n.label=t.name,n.request={withTrashed:!0,where:[{label:"equipment_type_id",condition:"=",value:t.id}],paginate:20},n.fab={template:"/app/components/settings/templates/dialogs/equipment-dialog.template.html",controller:"equipmentDialogController",action:"create",message:"Equipment created",equipment_type_id:t.id},n.action=function(e){o(e)},e.subheader.navs.push(n)}),o(e.subheader.navs[0])})},e.init()}]),app.controller("birthdaysToolbarController",["$scope","$state","$filter",function(e,t,o){e.toolbar.parentState="Settings",e.toolbar.childState="Birthdays",e.$on("close",function(){e.hideSearchBar()}),e.toolbar.getItems=function(t){var n=t?o("filter")(e.toolbar.items,t):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.model.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.model.page=1,e.model.no_matches=!1,e.model.items=[],e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.showInactive=!0,e.toolbar.sort=[{label:"First Name",type:"first_name",sortReverse:!1},{label:"Middle Name",type:"middle_name",sortReverse:!1},{label:"Last Name",type:"last_name",sortReverse:!1},{label:"LOB",type:"lob",sortReverse:!1},{label:"Birthdate",type:"birthdate",sortReverse:!1},{label:"Recently added",type:"created_at",sortReverse:!1}],e.toolbar.others=[{label:"Upload",action:function(){t.go("main.upload")}}],e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("equipmentToolbarController",["$scope","$filter",function(e,t){e.toolbar.parentState="Settings",e.toolbar.childState="Equipment",e.$on("close",function(){e.hideSearchBar()}),e.toolbar.getItems=function(o){var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.model.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.model.page=1,e.model.no_matches=!1,e.model.items=[],e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.showInactive=!0,e.toolbar.sort=[{label:"Brand",type:"brand",sortReverse:!1},{label:"Model",type:"model",sortReverse:!1},{label:"Asset Tag",type:"asset_tag",sortReverse:!1},{label:"Recently added",type:"created_at",sortReverse:!1}],e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("formsToolbarController",["$scope","$filter",function(e,t){e.toolbar.parentState="Settings",e.toolbar.childState="Forms",e.$on("close",function(){e.hideSearchBar()}),e.toolbar.getItems=function(o){var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.model.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.model.page=1,e.model.no_matches=!1,e.model.items=[],e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.showInactive=!0,e.toolbar.sort=[{label:"Name",type:"name",sortReverse:!1},{label:"Link",type:"form",sortReverse:!1},{label:"Recently added",type:"created_at",sortReverse:!1}],e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("groupsToolbarController",["$scope","$filter",function(e,t){e.toolbar.parentState="Settings",e.toolbar.childState="Groups",e.$on("close",function(){e.hideSearchBar()}),e.toolbar.getItems=function(o){var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.model.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.model.page=1,e.model.no_matches=!1,e.model.items=[],e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.showInactive=!0,e.toolbar.sort=[{label:"Name",type:"name",sortReverse:!1},{label:"Recently added",type:"created_at",sortReverse:!1}],e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("linksToolbarController",["$scope","$filter",function(e,t){e.toolbar.parentState="Settings",e.toolbar.childState="Links",e.$on("close",function(){e.hideSearchBar()}),e.toolbar.getItems=function(o){var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.model.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.model.page=1,e.model.no_matches=!1,e.model.items=[],e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.showInactive=!0,e.toolbar.sort=[{label:"Name",type:"name",sortReverse:!1},{label:"Link",type:"link",sortReverse:!1},{label:"Recently added",type:"created_at",sortReverse:!1}],e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("locationsToolbarController",["$scope","$filter",function(e,t){e.toolbar.parentState="Settings",e.toolbar.childState="Rooms",e.$on("close",function(){e.hideSearchBar()}),e.toolbar.getItems=function(o){var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.model.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.model.page=1,e.model.no_matches=!1,e.model.items=[],e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.showInactive=!0,e.toolbar.sort=[{label:"Name",type:"name",sortReverse:!1},{label:"Recently added",type:"created_at",sortReverse:!1}],e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("uploadToolbarController",["$scope","$state","$filter",function(e,t,o){e.toolbar.parentState="Upload",e.toolbar.childState="Birthdays",e.$on("close",function(){e.hideSearchBar()}),e.toolbar.getItems=function(t){var n=t?o("filter")(e.toolbar.items,t):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.model.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.model.page=1,e.model.no_matches=!1,e.model.items=[],e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("usersToolbarController",["$scope","$filter",function(e,t){e.toolbar.parentState="Settings",e.toolbar.childState="Users",e.$on("close",function(){e.hideSearchBar()}),e.toolbar.getItems=function(o){var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.model.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.model.page=1,e.model.no_matches=!1,e.model.items=[],e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.showInactive=!0,e.toolbar.sort=[{label:"Name",type:"name",sortReverse:!1},{label:"Email",type:"email",sortReverse:!1},{label:"Recently added",type:"created_at",sortReverse:!1}],e.toolbar.refresh=function(){e.$emit("refresh")}}]),app.controller("postDialogController",["$scope","Helper","FileUploader",function(e,t,o){e.config=t.fetch();var n={};n.self_group=!0,t.post("/group/enlist",n).success(function(t){e.groups=t}),e.repost={},e.post={},e.post.group_id="all",e.post.chips=[];var r={};if(r.filter={name:"photoFilter",fn:function(e,t){var o="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(o)!==-1}},r.sizeFilter={name:"enforceMaxFileSize",fn:function(e){return e.size<=10485760}},r.error=function(t,o,n){e.fileError=!0,e.postPhotoUploader.queue=[]},r.headers={"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},e.clickUpload=function(){angular.element("#post-upload").trigger("click")},e.postPhotoUploader=new o({url:"/temp-upload/upload-photo",headers:r.headers,queueLimit:1}),"edit"==e.config.action){e.currentTime=Date.now();var n={};n["with"]=[{relation:"hashtags",withTrashed:!1}],n.where=[{label:"id",condition:"=",value:e.config.id}],n.first=!0,t.post("/post/enlist",n).success(function(t){t.chips=[],angular.forEach(t.hashtags,function(e){t.chips.push(e.tag)}),e.post=t,e.post.group_id=t.group_id?t.group_id:"all",e.post.allow_comments=!!t.allow_comments}).error(function(){t.error()})}e.duplicate=!1,e.busy=!1,e.postPhotoUploader.filters.push(r.filter),e.postPhotoUploader.filters.push(r.sizeFilter),e.postPhotoUploader.onWhenAddingFileFailed=r.error,e.postPhotoUploader.onAfterAddingFile=function(){e.fileError=!1,e.postPhotoUploader.queue.length&&e.postPhotoUploader.uploadAll()},e.postPhotoUploader.onCompleteItem=function(t,o){e.temp_upload=o,e.post.image_path=o.path,o&&(e.preview=!0,e.currentTime=Date.now())},e.postPhotoUploader.onErrorItem=function(){t.error()},e.replace=function(){e.postPhotoUploader.queue=[],e.clickUpload()},e.cancel=function(){t.cancel()},e.submit=function(){return e.postForm.$invalid?void angular.forEach(e.postForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):void(e.duplicate||(e.busy=!0,"create"==e.config.action?t.post("/post",e.post).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0}):"edit"==e.config.action&&t.put("/post/"+e.config.id,e.post).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0})))}}]),app.controller("repostDialogController",["$scope","Helper",function(e,t){e.config=t.fetch();var o={};if(o.self_group=!0,t.post("/group/enlist",o).success(function(t){e.groups=t}),e.repost={},"create"==e.config.action){var o={};o["with"]=[{relation:"hashtags",withTrashed:!1},{relation:"user",withTrashed:!0},{relation:"group",withTrashed:!0}],o.where=[{label:"id",condition:"=",value:e.config.id}],o.first=!0,t.post("/post/enlist",o).success(function(t){t.created_at=new Date(t.created_at),t.chips=[],angular.forEach(t.hashtags,function(e){t.chips.push(e.tag)}),e.repost.post=t,e.repost.post.allow_comments=!!t.allow_comments,e.repost.group_id=t.group_id?t.group_id:"all"}).error(function(){t.error()})}else if("edit"==e.config.action){var o={};o["with"]=[{relation:"post",withTrashed:!1}],o.where=[{label:"id",condition:"=",value:e.config.id}],o.first=!0,t.post("/repost/enlist",o).success(function(o){o.post.created_at=new Date(o.post.created_at),o.post.chips=[],angular.forEach(o.post.hashtags,function(e){o.post.chips.push(e.tag)}),e.repost.post=o.post,e.repost.post.allow_comments=!!o.post.allow_comments,e.repost.group_id=o.post.group_id?o.post.group_id:"all",t.get("/post/"+e.config.id).success(function(t){e.repost.id=t.repost_id,e.repost.title=t.title,e.repost.allow_comments=!!t.allow_comments,e.repost.group_id=t.group_id?t.group_id:"all"})}).error(function(){t.error()})}e.busy=!1,e.cancel=function(){t.cancel()},e.submit=function(){return e.repostForm.$invalid?void angular.forEach(e.repostForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}):(e.busy=!0,void("create"==e.config.action?t.post("/repost",e.repost).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0}):"edit"==e.config.action&&t.put("/repost/"+e.config.id,e.repost).success(function(o){return o?void(e.busy=!1):void t.stop()}).error(function(){e.busy=!1,e.error=!0})))}}]),app.controller("repostsDialogController",["$scope","Helper",function(e,t){e.cancel=function(){t.cancel()};var o=t.fetch(),n={};n["with"]=[{relation:"post",withTrashed:!1}],n.where=[{label:"post_id",condition:"=",value:o.id}],n.orderBy=[{column:"created_at",order:"desc"}],n.paginate=10,e.repost={},e.repost.items=[],e.repost.page=2;var r=function(e){e.created_at=new Date(e.created_at)};t.post("/repost/enlist",n).success(function(o){e.repost.details=o,e.repost.items=o.data,e.repost.show=!0,o.data.length&&angular.forEach(o.data,function(e){r(e)}),e.repost.paginateLoad=function(){return e.repost.busy||e.repost.page>e.repost.details.last_page?void(e.isLoading=!1):(e.repost.busy=!0,e.isLoading=!0,void t.post("/repost/enlist?page="+e.repost.page,n).success(function(t){e.repost.page++,angular.forEach(t.data,function(t,o){r(t),e.repost.items.push(t)}),e.repost.busy=!1,e.isLoading=!1}))}})}]),app.controller("postsToolbarController",["$scope","$filter",function(e,t){e.toolbar.childState="Home",e.$on("close",function(){e.hideSearchBar()}),e.$on("open",function(){e.showSearchBar(),e.searchUserInput()}),e.toolbar.getItems=function(o){var n=o?t("filter")(e.toolbar.items,o):e.toolbar.items;return n},e.toolbar.searchAll=!0,e.showSearchBar=function(){e.post.busy=!0,e.searchBar=!0},e.hideSearchBar=function(){e.searchBar=!1,e.toolbar.searchText="",e.toolbar.searchItem="",e.searched&&(e.searched=!1,e.$emit("refresh"))},e.searchUserInput=function(){e.$emit("search"),e.searched=!0},e.toolbar.options=!0,e.toolbar.refresh=function(){e.$emit("refresh")}}]);